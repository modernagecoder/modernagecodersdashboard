<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Age Coders - Teacher Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://npmcdn.com/flatpickr/dist/themes/dark.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
    <!-- Loading State -->
    <div class="page-loading">
        <div class="spinner"></div>
        <div class="loading-text">Loading dashboard...</div>
    </div>

    <!-- Sidebar Overlay (mobile) -->
    <div class="sidebar-overlay"></div>

    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" aria-label="Toggle menu">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
            <path fill-rule="evenodd"
                d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
        </svg>
    </button>

    <!-- Sidebar -->
    <aside class="sidebar">
        <!-- Sidebar Collapse Toggle -->
        <!-- Sidebar Collapse Toggle removed -->
        <div class="sidebar-logo">
            <img src="logo.jpeg" alt="Modern Age Coders" class="logo-img" width="80" height="auto">
        </div>

        <div class="sidebar-profile">
            <div class="profile-avatar">T</div>
            <div class="profile-info">
                <div class="profile-name">Teacher</div>
                <div class="profile-role teacher">Teacher</div>
            </div>
        </div>

        <nav class="sidebar-nav">
            <!-- Teacher nav items -->
            <a href="#" class="nav-item active" data-section="schedule" data-tooltip="Schedule">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z" />
                </svg>
                <span>Schedule</span>
            </a>
            <a href="#" class="nav-item" data-section="my-students" data-tooltip="My Students">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
                    <path fill-rule="evenodd"
                        d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z" />
                    <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z" />
                </svg>
                <span>My Students</span>
            </a>
            <a href="#" class="nav-item" data-section="assignments" data-tooltip="Assignments">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM4.5 9a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1h-7zM4 10.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm.5 2.5a.5.5 0 0 1 0-1h4a.5.5 0 0 1 0 1h-4z" />
                </svg>
                <span>Assignments</span>
            </a>
            <a href="#" class="nav-item" data-section="salary-history" data-tooltip="Salary History">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1H1zm7 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z" />
                    <path
                        d="M0 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V5zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V7a2 2 0 0 1-2-2H3z" />
                </svg>
                <span>Salary History</span>
            </a>
            <a href="#" class="nav-item" data-section="announcements" data-tooltip="Announcements">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zM8 1.918l-.797.161A4.002 4.002 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4.002 4.002 0 0 0-3.203-3.92L8 1.917zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5.002 5.002 0 0 1 13 6c0 .88.32 4.2 1.22 6z" />
                </svg>
                <span>Announcements</span>
                <span id="sidebar-notification-dot" class="sidebar-badge hidden"></span>
            </a>

            <!-- Admin-only nav items (hidden by default) -->
            <div id="admin-nav-items" class="hidden">
                <div class="nav-separator">Admin</div>
                <a href="#" class="nav-item" data-section="admin-dashboard" data-tooltip="Dashboard Stats">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                            d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5h-2v12h2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z" />
                    </svg>
                    <span>Dashboard Stats</span>
                </a>
                <a href="#" class="nav-item" data-section="teacher-overview" data-tooltip="Teacher Overview">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                            d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816zM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275zM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z" />
                    </svg>
                    <span>Teacher Overview</span>
                </a>
                <a href="#" class="nav-item" data-section="manage-teachers" data-tooltip="Manage Teachers">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                            d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0Zm-2-6a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" />
                        <path
                            d="M8.256 14a4.474 4.474 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10c.26 0 .507.009.74.025.226-.341.496-.65.804-.918C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4s1 1 1 1h5.256Z" />
                    </svg>
                    <span>Manage Teachers</span>
                </a>
                <a href="#" class="nav-item" data-section="manage-students" data-tooltip="Manage Students">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                            d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816zM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275zM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z" />
                    </svg>
                    <span>Manage Students</span>
                </a>
                <a href="#" class="nav-item" data-section="manage-batches" data-tooltip="Manage Batches">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                            d="M9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.825a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31L.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.638l-.707-.707A1 1 0 0 0 6.414 2H2.5a1 1 0 0 0-.998.94l.006.18z" />
                    </svg>
                    <span>Manage Batches</span>
                </a>
                <a href="#" class="nav-item" data-section="admin-announcements" data-tooltip="Announcements Mgr">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                            d="M13.106 7.222c0-2.967-2.249-5.032-5.482-5.032-3.35 0-5.646 2.318-5.646 5.702 0 3.493 2.235 5.708 5.762 5.708.862 0 1.689-.123 2.304-.335v-.862c-.43.199-1.354.328-2.29.328-2.926 0-4.813-1.88-4.813-4.798 0-2.844 1.921-4.881 4.594-4.881 2.735 0 4.608 1.688 4.608 4.156 0 1.682-.554 2.769-1.416 2.769-.492 0-.772-.28-.772-.76V5.206H8.923v.834h-.11c-.266-.595-.881-.964-1.6-.964-1.4 0-2.378 1.162-2.378 2.823 0 1.737.957 2.906 2.379 2.906.8 0 1.415-.39 1.709-1.087h.11c.081.67.703 1.148 1.503 1.148 1.572 0 2.57-1.415 2.57-3.643zm-7.177.704c0-1.197.54-1.907 1.456-1.907.93 0 1.524.738 1.524 1.907S8.308 9.84 7.371 9.84c-.895 0-1.442-.725-1.442-1.914z" />
                    </svg>
                    <span>Announcements Mgr</span>
                </a>
            </div>
        </nav>

        <div class="sidebar-footer">
            <button id="logout-button" class="nav-item logout-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                    <path fill-rule="evenodd"
                        d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z" />
                    <path fill-rule="evenodd"
                        d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z" />
                </svg>
                <span>Logout</span>
            </button>
        </div>
    </aside>

    <!-- Main Content Area -->
    <div class="main-content" style="opacity: 0;">

        <header id="app-header">
            <div id="header-main-content">
                <h1 id="main-title">Weekly Schedule</h1>
                <div id="user-info">
                    <span id="user-display-name"></span>
                    <button id="notification-bell" title="View Announcements" class="hidden">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                            viewBox="0 0 16 16">
                            <path
                                d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2zM8 1.918l-.797.161A4.002 4.002 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4.002 4.002 0 0 0-3.203-3.92L8 1.917zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5.002 5.002 0 0 1 13 6c0 .88.32 4.2 1.22 6z" />
                        </svg>
                        <span id="notification-dot"></span>
                    </button>
                </div>
            </div>

            <div id="header-secondary-content">
                <div id="header-left-group">
                    <div id="current-date-display-container">
                        <div id="current-date-display">Loading date...</div>
                    </div>
                    <!-- Cancellation metric removed -->
                </div>

                <div id="all-stats-wrapper">
                    <!-- Stats moved to Salary Section -->
                </div>
            </div>
        </header>

        <!-- ===== SECTION: Schedule (Default) ===== -->
        <section id="section-schedule" class="dashboard-section">
            <div id="main-schedule-content">
                <!-- Salary highlight removed -->

                <div id="pending-classes-warning" class="hidden">
                    <strong>Action Required:</strong> You have unmarked classes on the following date(s): <strong
                        id="warning-dates" style="color: var(--text-primary);"></strong>. Please update their status to
                    ensure your salary is calculated correctly.
                </div>

                <div id="schedule-announcement">
                    <strong>Friendly Reminder:</strong> Please finalize your schedule before <strong>10:00 AM</strong>.
                    This
                    helps everyone organize their day effectively.
                </div>

                <div id="week-navigation">
                    <button id="prev-week-button" class="btn nav-arrow" title="Previous Week">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 16 16"
                            fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M12 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5a.5.5 0 0 1 .5.5z" />
                        </svg>
                    </button>
                    <div id="week-selector"></div>
                    <button id="next-week-button" class="btn nav-arrow" title="Next Week">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 16 16"
                            fill="currentColor">
                            <path fill-rule="evenodd"
                                d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8z" />
                        </svg>
                    </button>
                </div>

                <div id="day-schedule-view" class="hidden">
                    <hr class="mb-2 mt-2" style="border-color: var(--border-color);">
                    <p id="motivational-quote" class="text-center mt-1 mb-2"
                        style="color: var(--accent-green); font-style: italic; min-height: 1.5em;"></p>
                    <div style="display:flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;"
                        class="mb-2">
                        <h2 id="day-title" style="margin-bottom: 0;"></h2>
                        <div
                            style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: flex-end; flex-grow: 1;">
                            <button id="add-slot-button" class="btn btn-primary">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                    class="bi bi-plus-lg" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd"
                                        d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z" />
                                </svg>
                                Add Class Slot
                            </button>
                        </div>
                    </div>

                    <div id="license-timeline-view">
                        <h3 class="license-timeline-title">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                                viewBox="0 0 16 16">
                                <path
                                    d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z" />
                                <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z" />
                            </svg>
                            License Availability for the Day
                        </h3>
                        <div id="license-timeline-container"></div>
                        <div class="timeline-axis">
                            <span>6AM</span><span>7AM</span><span>8AM</span><span>9AM</span><span>10AM</span><span>11AM</span><span>12PM</span><span>1PM</span><span>2PM</span><span>3PM</span><span>4PM</span><span>5PM</span><span>6PM</span><span>7PM</span><span>8PM</span><span>9PM</span><span>10PM</span><span>11PM</span><span>12AM</span><span>1AM</span>
                        </div>
                    </div>
                    <div id="slots-list" class="mt-2"></div>

                    <p id="no-slots-message" class="text-center hidden mt-3"
                        style="font-style: italic; color: var(--text-muted);">No classes scheduled for this day. Enjoy
                        your
                        free time or add a new class!</p>
                </div>
            </div>
        </section>

        <!-- ===== SECTION: My Students ===== -->
        <section id="section-my-students" class="dashboard-section hidden">
            <div class="section-header">
                <div>
                    <h2>My Students</h2>
                    <p class="section-subtitle">Students assigned to you</p>
                </div>
            </div>

            <!-- Teacher: My Students Panel -->
            <div id="teacher-my-students-panel" class="teacher-panel-section">
                <div class="teacher-panel-header" id="teacher-my-students-header">
                    <h3>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
                            <path fill-rule="evenodd"
                                d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z" />
                            <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z" />
                        </svg>
                        My Students <span id="teacher-students-count"
                            style="font-weight:400; font-size:0.8rem; color:var(--text-muted);"></span>
                    </h3>
                    <svg class="panel-toggle" xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                            d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z" />
                    </svg>
                </div>
                <div id="teacher-my-students-body" class="teacher-panel-body">
                    <div class="teacher-panel-body-inner">
                        <div id="teacher-my-students-list">
                            <div class="teacher-students-empty">Loading students...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Teacher: Today's Agenda Panel -->
            <div id="teacher-agenda-panel" class="teacher-agenda-panel">
                <h3>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z" />
                        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z" />
                    </svg>
                    Today's Agenda
                </h3>
                <div id="teacher-agenda-list">
                    <div class="agenda-empty">No classes today</div>
                </div>
            </div>
        </section>

        <!-- ===== SECTION: Assignments ===== -->
        <section id="section-assignments" class="dashboard-section hidden">
            <div class="section-header">
                <div>
                    <h2>Assignments</h2>
                    <p class="section-subtitle">Manage homework and assignments for your students</p>
                </div>
                <button id="open-assignment-modal-btn" class="btn btn-primary">Post Assignment</button>
            </div>
            <div id="teacher-assignments-list">
                <div class="empty-state">
                    <div class="empty-icon">&#128203;</div>
                    <p>Select a batch and post assignments to your students.</p>
                </div>
            </div>
        </section>

        <!-- ===== SECTION: Salary History ===== -->
        <section id="section-salary-history" class="dashboard-section hidden">
            <div class="section-header">
                <div>
                    <h2>Salary History</h2>
                    <p class="section-subtitle">View your earnings and salary breakdown</p>
                </div>
            </div>
            <div id="salary-section-content">
                <!-- Copied from header -->
                <div id="teacher-stats-container">
                    <div class="stat-item teacher-stat-enhanced">
                        <div class="stat-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                <path
                                    d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-5 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z" />
                                <path
                                    d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z" />
                            </svg>
                        </div>
                        <span class="stat-value" id="stats-selected-day">0</span>
                        <span class="stat-label">Classes Today</span>
                    </div>
                    <div class="stat-item teacher-stat-enhanced">
                        <div class="stat-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                <path
                                    d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM2 2a1 1 0 0 0-1 1v1h14V3a1 1 0 0 0-1-1H2zm13 3H1v9a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V5z" />
                            </svg>
                        </div>
                        <span class="stat-value" id="stats-current-month">0</span>
                        <span class="stat-label">Classes This Month</span>
                    </div>
                    <div class="stat-item teacher-stat-enhanced">
                        <div class="stat-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                <path
                                    d="M4 10.781c.148 1.667 1.513 2.85 3.591 3.003V15h1.043v-1.216c2.27-.179 3.678-1.438 3.678-3.3 0-1.59-.947-2.51-2.956-3.028l-.722-.187V3.467c1.122.11 1.879.714 2.07 1.616h1.47c-.166-1.6-1.54-2.748-3.54-2.875V1H7.591v1.233c-1.939.23-3.27 1.472-3.27 3.156 0 1.454.966 2.483 2.661 2.917l.61.162v4.031c-1.149-.17-1.94-.8-2.131-1.718H4zm3.391-3.836c-1.043-.263-1.6-.825-1.6-1.616 0-.944.704-1.641 1.8-1.828v3.495l-.2-.05zm1.591 1.872c1.287.323 1.852.859 1.852 1.769 0 1.097-.826 1.828-2.2 1.939V8.73l.348.086z" />
                            </svg>
                        </div>
                        <span class="stat-value earnings" id="stats-today-earnings">&#8377;0</span>
                        <span class="stat-label">Today's Earnings</span>
                    </div>
                    <div class="stat-item teacher-stat-enhanced">
                        <div class="stat-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1H1zm7 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z" />
                                <path
                                    d="M0 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V5zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V7a2 2 0 0 1-2-2H3z" />
                            </svg>
                        </div>
                        <span class="stat-value earnings" id="stats-monthly-earnings">&#8377;0</span>
                        <span class="stat-label">Monthly Earnings</span>
                    </div>
                </div>
                <!-- Salary highlight box will be cloned/referenced here -->

                <div id="salary-history-container" style="margin-top: 2rem;">
                    <div id="salary-history-loader" class="hidden"
                        style="text-align: center; padding: 2rem; color: var(--text-muted);">
                        Loading salary history...
                    </div>
                    <div id="salary-history-list"></div>
                </div>
            </div>
    </div>
    </section>

    <!-- ===== SECTION: Announcements ===== -->
    <section id="section-announcements" class="dashboard-section hidden">
        <div class="section-header">
            <div>
                <h2>Announcements</h2>
                <p class="section-subtitle">Important updates from the admin</p>
            </div>
        </div>
        <div id="announcements-section-content">
            <div id="teacher-announcements-inline-list">
                <div class="empty-state">
                    <div class="empty-icon">&#128227;</div>
                    <p>No announcements at this time.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== SECTION: Admin Dashboard Stats ===== -->
    <section id="section-admin-dashboard" class="dashboard-section hidden">
        <div class="section-header">
            <div>
                <h2>Dashboard Stats</h2>
                <p class="section-subtitle">Platform-wide metrics and overview</p>
            </div>
        </div>
        <div id="admin-dashboard-container" class="admin-dashboard-container">
            <div class="admin-stats-row">
                <div class="admin-stat-card">
                    <svg class="admin-stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z">
                        </path>
                    </svg>
                    <div class="admin-stat-value" id="admin-total-students">0</div>
                    <div class="admin-stat-label">Total Students</div>
                </div>
                <div class="admin-stat-card">
                    <svg class="admin-stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z">
                        </path>
                    </svg>
                    <div class="admin-stat-value" id="admin-total-teachers">0</div>
                    <div class="admin-stat-label">Total Teachers</div>
                </div>
                <div class="admin-stat-card">
                    <svg class="admin-stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10">
                        </path>
                    </svg>
                    <div class="admin-stat-value" id="admin-total-batches">0</div>
                    <div class="admin-stat-label">Active Batches</div>
                </div>
                <div class="admin-stat-card revenue">
                    <svg class="admin-stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z">
                        </path>
                    </svg>
                    <div class="admin-stat-value" id="admin-total-revenue">$0</div>
                    <div class="admin-stat-label">Total Revenue</div>
                </div>
            </div>

            <div class="admin-content-grid">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 002 2h2a2 2 0 002-2z">
                                </path>
                            </svg>
                            Teacher Earnings
                        </h3>
                    </div>
                    <div id="revenue-breakdown-list">
                        <p class="text-muted">Loading data...</p>
                    </div>
                </div>

                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            Quick Actions
                        </h3>
                    </div>
                    <div class="quick-actions-grid">
                        <div class="action-card" id="quick-action-students">
                            <div class="action-icon">
                                <i class="fas fa-user-graduate"></i>
                            </div>
                            <div class="action-info">
                                <h4>Manage Students</h4>
                                <p>Add, edit, or assign</p>
                            </div>
                        </div>
                        <div class="action-card batches" id="quick-action-batches">
                            <div class="action-icon">
                                <i class="fas fa-layer-group"></i>
                            </div>
                            <div class="action-info">
                                <h4>Manage Batches</h4>
                                <p>Create and organize</p>
                            </div>
                        </div>
                        <div class="action-card teachers" id="quick-action-teachers">
                            <div class="action-icon">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                            <div class="action-info">
                                <h4>Manage Teachers</h4>
                                <p>Staff and permissions</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ===== SECTION: Teacher Overview (Admin) ===== -->
    <section id="section-teacher-overview" class="dashboard-section hidden">
        <div class="section-header">
            <div>
                <h2>Teacher Overview</h2>
                <p class="section-subtitle">Weekly schedule overview for all teachers</p>
            </div>
        </div>
        <div id="teacher-overview-view">
            <div id="overview-navigation">
                <button id="overview-prev-week-button" class="btn nav-arrow" title="Previous Week">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 16 16"
                        fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M12 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5a.5.5 0 0 1 .5.5z" />
                    </svg>
                </button>
                <div id="overview-week-display">Loading...</div>
                <button id="overview-next-week-button" class="btn nav-arrow" title="Next Week">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 16 16"
                        fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M4 8a.5.5 0 0 1 .5-.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5A.5.5 0 0 1 4 8z" />
                    </svg>
                </button>
            </div>
            <div id="overview-grid-container">
                <div id="overview-loader">Fetching schedule data...</div>
            </div>
        </div>
    </section>

    <!-- ===== SECTION: Manage Teachers (Admin) ===== -->
    <section id="section-manage-teachers" class="dashboard-section hidden">
        <div class="section-header">
            <div>
                <h2>Manage Teachers</h2>
                <p class="section-subtitle">Add, edit, and manage teacher accounts</p>
            </div>
        </div>
        <div class="management-section-content">
            <div class="management-card">
                <h3>Teacher Accounts</h3>
                <p>Create new teacher accounts, update existing ones, or manage permissions.</p>
                <button class="btn btn-primary" id="open-teacher-mgmt-btn">Open Teacher Manager</button>
            </div>
        </div>
    </section>

    <!-- ===== SECTION: Manage Students (Admin) ===== -->
    <section id="section-manage-students" class="dashboard-section hidden">
        <div class="section-header">
            <div>
                <h2>Manage Students</h2>
                <p class="section-subtitle">Add, edit, and assign students</p>
            </div>
        </div>
        <div class="management-section-content">
            <div class="management-card">
                <h3>Student Accounts</h3>
                <p>Create new student accounts, assign them to teachers and batches.</p>
                <button class="btn btn-primary" id="open-student-mgmt-btn">Open Student Manager</button>
            </div>
        </div>
    </section>

    <!-- ===== SECTION: Manage Batches (Admin) ===== -->
    <section id="section-manage-batches" class="dashboard-section hidden">
        <div class="section-header">
            <div>
                <h2>Manage Batches</h2>
                <p class="section-subtitle">Create and organize class batches</p>
            </div>
        </div>
        <div class="management-section-content">
            <div class="management-card">
                <h3>Batch Management</h3>
                <p>Create new batches, rename, or delete existing ones.</p>
                <button class="btn btn-primary" id="open-batch-mgmt-btn">Open Batch Manager</button>
            </div>
        </div>
    </section>

    <!-- ===== SECTION: Admin Announcements Manager ===== -->
    <section id="section-admin-announcements" class="dashboard-section hidden">
        <div class="section-header">
            <div>
                <h2>Announcements Manager</h2>
                <p class="section-subtitle">Create and manage platform announcements</p>
            </div>
        </div>
        <div class="management-section-content">
            <div class="management-card">
                <h3>Announcements</h3>
                <p>Publish announcements that all teachers will see on their dashboard.</p>
                <button class="btn btn-warning" id="open-announcements-mgmt-btn">Open Announcements Manager</button>
            </div>
        </div>
    </section>

    </div>

    <!-- ============================================ -->
    <!-- SLOT MODAL -->
    <!-- ============================================ -->
    <div id="slot-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Add Class Slot</h3>
                <button class="close-button" id="close-modal-button">&times;</button>
            </div>
            <input type="hidden" id="slot-id">

            <div id="teacher-select-container-for-admin" class="hidden mb-2">
                <label for="modal-teacher-select">Assign to Teacher:</label>
                <select id="modal-teacher-select" required class="mb-1" style="width: 100%;"></select>
            </div>

            <div id="modal-tag-container" class="hidden mb-2">
                <label for="modal-tag-select">Class Type (Compulsory):</label>
                <select id="modal-tag-select" style="width: 100%;">
                    <option value="none">Not Specified</option>
                    <option value="group">Group Class (&#8377;200)</option>
                    <option value="personalized">Personalized Class (&#8377;125)</option>
                </select>
            </div>

            <div id="modal-batch-container" class="mb-2">
                <label for="modal-batch-select">Batch / Student:</label>
                <select id="modal-batch-select" style="width: 100%;">
                    <option value="">-- Select Batch --</option>
                </select>
            </div>

            <div id="apply-tag-to-future-container" class="hidden mb-2"
                style="display: flex; align-items: center; background-color: var(--bg-primary); padding: 12px; border-radius: var(--border-radius); border: 1px solid var(--border-color);">
                <input type="checkbox" id="apply-tag-to-future-checkbox">
                <label for="apply-tag-to-future-checkbox"
                    style="margin-bottom: 0; font-weight: normal; user-select: none;">Apply this tag to all future
                    classes in this series</label>
            </div>
            <div class="time-inputs-container">
                <div>
                    <label for="start-time">Start Time:</label>
                    <input type="text" id="start-time" placeholder="Select start time" required>
                </div>
                <div>
                    <label for="duration-select">Duration:</label>
                    <select id="duration-select" required>
                        <option value="30">30 minutes</option>
                        <option value="45">45 minutes</option>
                        <option value="60" selected>1 hour</option>
                        <option value="75">1 hour 15 minutes</option>
                        <option value="90">1 hour 30 minutes</option>
                        <option value="105">1 hour 45 minutes</option>
                        <option value="120">2 hours</option>
                        <option value="150">2 hours 30 minutes</option>
                        <option value="180">3 hours</option>
                    </select>
                </div>
            </div>
            <label for="topic">Topic / Subject:</label>
            <input type="text" id="topic"
                placeholder="e.g., Comet Coders grade 8, Personalized class of Arav, Maths classes of .." required
                class="mb-2">

            <div id="recurring-container" class="mb-2" style="display: flex; align-items: center; margin-top: 1rem;">
                <input type="checkbox" id="recurring-checkbox">
                <label for="recurring-checkbox" style="margin-bottom: 0; font-weight: normal; user-select: none;">Repeat
                    this class every week</label>
            </div>

            <button id="save-slot-button" class="btn btn-success" style="width:100%;">Save Slot</button>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- DELETE CONFIRM MODAL -->
    <!-- ============================================ -->
    <div id="delete-confirm-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="delete-modal-title">Confirm Deletion</h3>
                <button class="close-button" id="close-delete-modal-button">&times;</button>
            </div>
            <p id="delete-modal-message" class="mb-2">Are you sure you want to permanently delete this class slot?</p>

            <div id="delete-options-container" class="hidden mb-2">
                <div style="display: flex; align-items: center; margin-bottom: 0.75rem;">
                    <input type="radio" id="delete-option-single" name="delete-option" value="single" checked>
                    <label for="delete-option-single" style="margin-bottom: 0; font-weight: normal;">Delete only this
                        instance</label>
                </div>
                <div style="display: flex; align-items: center;">
                    <input type="radio" id="delete-option-future" name="delete-option" value="future">
                    <label for="delete-option-future" style="margin-bottom: 0; font-weight: normal;">Delete this and all
                        future instances</label>
                </div>
            </div>

            <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 1.5rem;">
                <button id="cancel-delete-button" class="btn btn-secondary">Cancel</button>
                <button id="confirm-delete-button" class="btn btn-danger">Confirm Deletion</button>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- SALARY HISTORY MODAL -->
    <!-- ============================================ -->
    <div id="salary-history-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Salary History</h3>
                <button class="close-button" id="close-salary-history-modal-button">&times;</button>
            </div>
            <p class="text-muted mb-2">Showing total earnings for completed classes for each of the last 12 months.</p>
            <div id="salary-history-list">
                <div id="salary-history-loader" class="hidden">Loading history...</div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ANNOUNCEMENT MODAL (Teacher read-only) -->
    <!-- ============================================ -->
    <div id="announcement-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>All Announcements</h3>
                <button class="close-button" id="close-announcement-modal-button">&times;</button>
            </div>
            <div id="teacher-announcements-list" style="max-height: 60vh; overflow-y: auto; padding-right: 10px;">
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ADMIN: ANNOUNCEMENTS MANAGER MODAL -->
    <!-- ============================================ -->
    <div id="admin-announcements-manager-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Manage Announcements</h3>
                <button class="close-button" id="close-admin-manager-modal-button">&times;</button>
            </div>

            <div id="create-announcement-section"
                style="background-color: var(--bg-primary); padding: 20px; border-radius: var(--border-radius); border: 1px solid var(--border-color); margin-bottom: 2rem;">
                <h4
                    style="color: var(--accent-secondary); margin-top: 0; margin-bottom: 1rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem;">
                    Create New Announcement</h4>
                <p style="color: var(--text-muted); margin-top: -0.5rem; margin-bottom: 1.5rem; font-size: 0.9em;">This
                    message will be pushed to all teachers and added to the history below.</p>
                <label for="new-announcement-textarea">Announcement Message:</label>
                <textarea id="new-announcement-textarea" placeholder="Type your message here..."></textarea>
                <button id="publish-new-announcement-button" class="btn btn-success" style="width:100%;">Publish New
                    Announcement</button>
            </div>

            <h4 style="color: var(--accent-secondary); margin-top: 0; margin-bottom: 1rem;">Announcement History</h4>
            <div id="announcements-history-list" style="max-height: 40vh; overflow-y: auto; padding-right: 10px;">
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ADMIN: TEACHER MANAGEMENT MODAL -->
    <!-- ============================================ -->
    <div id="teacher-management-modal" class="modal">
        <div class="modal-content" style="max-width: 700px; max-height: 85vh; overflow-y: auto;">
            <div class="modal-header">
                <h3>Manage Teachers</h3>
                <button class="close-button" id="close-teacher-modal-button">&times;</button>
            </div>

            <div id="create-teacher-section"
                style="background-color: var(--bg-primary); padding: 20px; border-radius: var(--border-radius); border: 1px solid var(--border-color); margin-bottom: 2rem;">
                <h4
                    style="color: var(--accent-green); margin-top: 0; margin-bottom: 1rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem;">
                    Add New Teacher
                </h4>
                <div style="display: grid; gap: 1rem;">
                    <div>
                        <label for="new-teacher-name">Teacher Name:</label>
                        <input type="text" id="new-teacher-name" placeholder="Enter full name" required>
                    </div>
                    <div>
                        <label for="new-teacher-email">Email Address:</label>
                        <input type="email" id="new-teacher-email" placeholder="teacher@example.com" required>
                    </div>
                    <div>
                        <label for="new-teacher-password">Password:</label>
                        <input type="password" id="new-teacher-password" placeholder="Minimum 6 characters" required>
                    </div>
                    <button id="create-teacher-button" class="btn btn-success" style="width:100%;">
                        Create Teacher Account
                    </button>
                </div>
            </div>

            <h4 style="color: var(--accent-secondary); margin-top: 0; margin-bottom: 1rem;">
                Existing Teachers
            </h4>
            <div style="margin-bottom: 1rem;">
                <input type="text" id="teacher-search-input" placeholder="Search teachers by name or email..."
                    style="width: 100%; padding: 0.6rem 1rem; border-radius: var(--border-radius); border: 1px solid var(--border-color); background: var(--bg-primary); color: var(--text-primary);">
            </div>
            <div id="teachers-list" style="max-height: 40vh; overflow-y: auto; padding-right: 10px;">
                <div id="teachers-loader" style="text-align: center; padding: 2rem; color: var(--text-muted);">
                    Loading teachers...
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ADMIN: STUDENT MANAGEMENT MODAL -->
    <!-- ============================================ -->
    <div id="student-management-modal" class="modal">
        <div class="modal-content" style="max-width: 700px; max-height: 85vh; overflow-y: auto;">
            <div class="modal-header">
                <h3>Manage Students</h3>
                <button class="close-button" id="close-student-modal-button">&times;</button>
            </div>

            <div id="create-student-section"
                style="background-color: var(--bg-primary); padding: 20px; border-radius: var(--border-radius); border: 1px solid var(--border-color); margin-bottom: 2rem;">
                <h4
                    style="color: var(--accent-green); margin-top: 0; margin-bottom: 1rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem;">
                    Add New Student
                </h4>
                <div style="display: grid; gap: 1rem;">
                    <div>
                        <label for="new-student-name">Student Name:</label>
                        <input type="text" id="new-student-name" placeholder="Enter full name" required>
                    </div>
                    <div>
                        <label for="new-student-email">Email Address:</label>
                        <input type="email" id="new-student-email" placeholder="student@example.com" required>
                    </div>
                    <div>
                        <label for="new-student-password">Password:</label>
                        <input type="password" id="new-student-password" placeholder="Minimum 6 characters" required>
                    </div>
                    <div>
                        <label>Batch:</label>
                        <div id="new-student-batch-container" style="position: relative;">
                            <select id="new-student-batch-select" style="width: 100%;">
                                <option value="">-- Select Batch --</option>
                            </select>
                            <div id="new-student-batch-chips"
                                style="display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px;"></div>
                        </div>
                    </div>
                    <div>
                        <label for="new-student-teacher">Assign to Teacher:</label>
                        <select id="new-student-teacher" style="width: 100%;">
                            <option value="">-- No Teacher Assigned --</option>
                        </select>
                    </div>
                    <button id="create-student-button" class="btn btn-success" style="width:100%;">
                        Create Student Account
                    </button>
                </div>
            </div>

            <h4 style="color: var(--accent-secondary); margin-top: 0; margin-bottom: 1rem;">
                Existing Students
            </h4>
            <div style="margin-bottom: 1rem;">
                <input type="text" id="student-search-input" placeholder="Search students by name, email, or teacher..."
                    style="width: 100%; padding: 0.6rem 1rem; border-radius: var(--border-radius); border: 1px solid var(--border-color); background: var(--bg-primary); color: var(--text-primary);">
            </div>
            <div id="students-list" style="max-height: 40vh; overflow-y: auto; padding-right: 10px;">
                <div id="students-loader" style="text-align: center; padding: 2rem; color: var(--text-muted);">
                    Loading students...
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ADMIN: BATCH MANAGEMENT MODAL -->
    <!-- ============================================ -->
    <div id="batch-management-modal" class="modal">
        <div class="modal-content" style="max-width: 550px; max-height: 85vh; overflow-y: auto;">
            <div class="modal-header">
                <h3>Manage Batches</h3>
                <button class="close-button" id="close-batch-modal-button">&times;</button>
            </div>

            <div
                style="background-color: var(--bg-primary); padding: 20px; border-radius: var(--border-radius); border: 1px solid var(--border-color); margin-bottom: 2rem;">
                <h4
                    style="color: var(--accent-green); margin-top: 0; margin-bottom: 1rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem;">
                    Add New Batch
                </h4>
                <div style="display: flex; gap: 10px; align-items: flex-end;">
                    <div style="flex: 1;">
                        <label for="new-batch-name">Batch Name:</label>
                        <input type="text" id="new-batch-name" placeholder="e.g., Grade 8, Python Batch"
                            style="margin-bottom: 0;">
                    </div>
                    <button id="add-batch-button" class="btn btn-success" style="height: 46px; white-space: nowrap;">Add
                        Batch</button>
                </div>
            </div>

            <h4 style="color: var(--accent-secondary); margin-top: 0; margin-bottom: 1rem;">
                Existing Batches
            </h4>
            <div id="batches-list" style="max-height: 40vh; overflow-y: auto; padding-right: 10px;">
                <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
                    No batches added yet.
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- TEACHER: ASSIGNMENT MODAL -->
    <!-- ============================================ -->
    <div id="assignment-modal" class="modal">
        <div class="modal-content" style="max-width: 550px;">
            <div class="modal-header">
                <h3>Post Assignment / Homework</h3>
                <button class="close-button" id="close-assignment-modal-button">&times;</button>
            </div>
            <div style="display: grid; gap: 1rem;">
                <div>
                    <label for="assignment-title">Title:</label>
                    <input type="text" id="assignment-title" placeholder="e.g., Chapter 5 Exercises" required>
                </div>
                <div>
                    <label for="assignment-description">Description:</label>
                    <textarea id="assignment-description" placeholder="Describe the assignment..." rows="3"></textarea>
                </div>
                <div>
                    <label for="assignment-due-date">Due Date:</label>
                    <input type="text" id="assignment-due-date" placeholder="Select date" required>
                </div>
                <div>
                    <label for="assignment-batch">Batch / Class:</label>
                    <select id="assignment-batch" style="width: 100%;">
                        <option value="">-- Select Batch --</option>
                    </select>
                </div>
                <div>
                    <label>Assign to Students:</label>
                    <div id="assignment-students-search-container" style="position: relative;">
                        <input type="text" id="assignment-students-search" placeholder="Search and select students..."
                            autocomplete="off" style="width: 100%;">
                        <div id="assignment-students-dropdown"
                            style="display: none; position: absolute; top: 100%; left: 0; right: 0; max-height: 200px; overflow-y: auto; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: var(--border-radius); z-index: 10; margin-top: 4px;">
                        </div>
                    </div>
                    <div id="assignment-selected-students"
                        style="display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px;"></div>
                </div>
                <button id="save-assignment-button" class="btn btn-success" style="width:100%;">Post Assignment</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications Container -->
    <div id="notifications"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <script type="module">
        import { initAuthGuard, handleLogout } from './js/auth-guard.js';
        import { initSidebar, setupDashboardNavigation } from './js/utils.js';
        import { initTeacherDashboard, handleSectionChange } from './js/teacher.js';

        // Initialize sidebar toggle for mobile
        initSidebar();

        // Setup section-based navigation
        setupDashboardNavigation((section) => {
            // Update main title based on active section
            const titles = {
                'schedule': 'Weekly Schedule',
                'my-students': 'My Students',
                'assignments': 'Assignments',
                'salary-history': 'Salary History',
                'announcements': 'Announcements',
                'admin-dashboard': 'Dashboard Stats',
                'teacher-overview': 'Teacher Overview',
                'manage-teachers': 'Manage Teachers',
                'manage-students': 'Manage Students',
                'manage-batches': 'Manage Batches',
                'admin-announcements': 'Announcements Manager'
            };
            const titleEl = document.getElementById('main-title');
            if (titleEl && titles[section]) titleEl.textContent = titles[section];

            // Toggle header visibility  only show stats header on schedule page
            const headerSecondary = document.getElementById('header-secondary-content');
            if (headerSecondary) {
                headerSecondary.style.display = section === 'schedule' ? '' : 'none';
            }

            // Trigger section-specific logic
            handleSectionChange(section);
        });

        // Logout button
        document.getElementById('logout-button').addEventListener('click', handleLogout);

        // Auth guard: require 'teacher' role (admin also allowed)
        initAuthGuard('teacher', (user, userData) => {
            // user is authenticated with teacher or admin role
            initTeacherDashboard(user, userData);
        });
    </script>
</body>

</html>